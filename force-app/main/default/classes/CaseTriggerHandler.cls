public class CaseTriggerHandler extends TriggerHandler {
    private List<Case> newCaseList;
    private case last_case;
    decimal autoNumber;
    public CaseTriggerHandler() {
        this.newCaseList = (List<Case>) Trigger.new;
        this.setMaxLoopCount(1);
    }
    public override void beforeInsert() {
        
        
        
        /*  Map<String,Schema.RecordTypeInfo> caseRecordTypeMap = Case.SObjectType.getDescribe().recordTypeInfosByDeveloperName;
for(Case ind : Trigger.new){
ind.RecordTypeId = caseRecordTypeMap.get(ind.Record_Type_Dev_Name__c).recordTypeId;
} */
        
        for(Case c : newCaseList){
            
            String caseType = c.Case_Type__c;
            String subCatType = c.Sub_Category_Type__c;
            Roles_to_AD_Groups_Mapping_Data__mdt dat= [SELECT Id,Agent_Group__c,Manager_Group__c,Queue__c,Stakeholders__c from Roles_to_AD_Groups_Mapping_Data__mdt where CaseType__c = :caseType and SubCategoryType__c= :subCatType LIMIT 1];
            last_case = [SELECT Id, Case_Display_Name__c FROM case where Case_Type__c = :caseType Order by CreatedDate desc limit 1];
            String agentGroup = dat.Agent_Group__c;
            if(last_case.Case_Display_Name__c != null && last_case.Case_Display_Name__c != ''){
                String autoNumberString = (last_case.Case_Display_Name__c).right(9);
                autoNumberString = autoNumberString.trim();
                autoNumber = Decimal.valueOf(autoNumberString);
            }else{
                autoNumber = 000000000;
            }
            String autogenerated = (String.valueOf(Integer.valueOf(autoNumber) + 1)).leftPad(9,'0');          
            if(caseType == 'Generic'){   
                c.Case_Display_Name__c= 'Gen'+autogenerated; 
                
            }
            if(caseType == 'Rewards Issues'){  
                c.Case_Display_Name__c= 'RI'+autogenerated; 
            }
            
            system.debug('datdatdatdatdat--->' +dat);
            c.Agent_Groupp__c = dat.Agent_Group__c;
            c.Manager_Groupp__c = dat.Manager_Group__c;
            c.Stake_holders__c = dat.Stakeholders__c;
            c.Assigned_to_Queue__c = dat.Queue__c; 
        }
    }
    
    
    
    
    
    public override void afterInsert() {
       
        for(Case iterateCase : newCaseList){
            system.debug('iterateCase--->'+ iterateCase);
            system.debug('iterateCase--->'+ iterateCase.Accountname__c);
            system.debug('Agent Group--->'+ iterateCase.Agent_Groupp__c);
            system.debug('Manager Group--->'+ iterateCase.Manager_Groupp__c);
            system.debug('Id--->'+ iterateCase.Id);
        
              CaseObject.methodname();
        }
    }  
}